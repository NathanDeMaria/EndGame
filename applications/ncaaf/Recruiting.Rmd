---
title: "Recruiting"
output: html_document
---

```{r data}
library(tidyverse)

ratings <- read_csv("ncaaf_recruiting.csv")
```

How many teams have non-zero ratings each year?
- Only ~50 teams get ratings 2000-2001.
- All FBS (I think?) has ratings 2002-2012
- After 2012, lots of teams

```{r yearly}
ratings %>% group_by(year) %>% summarise(rated_teams = sum(rating > 0)) %>%
  ggplot() + geom_line(aes(x = year, y = rated_teams)) +
  labs(x = 'Year', y = '# teams with non-zero ratings', title = 'Teams rated by year')
```

Total points goes up each year, so maybe think about normalizing.

```{r total}
ratings %>% group_by(year) %>% summarise(total_points = sum(rating)) %>%
  ggplot() + geom_line(aes(x = year, y = total_points)) +
  labs(x = "Year", y = "Total points", title = "Total points among all ratings by year")
```

Check out how the points at each ranking look year over year.

```{r drop-off}
ratings %>% mutate(year = as.factor(year)) %>%
  group_by(year) %>% mutate(rank = order(order(rating, decreasing = T))) %>%
  ggplot() + geom_line((aes(x = rank, y = rating, col = year))) +
  labs(x = 'Rank', y = 'Rating', title = 'Drop-off curves each year')
```

Try making the spread of points into a standard normal each year

```{r normalize}
normalize <- function(x) {
  (x - mean(x)) / sd(x)
}

ratings %>% mutate(year = as.factor(year)) %>%
  group_by(year) %>% mutate(rating = normalize(rating)) %>%
  mutate(rank = order(order(rating, decreasing = T))) %>%
  ggplot() + geom_line((aes(x = rank, y = rating, col = year))) +
  labs(x = 'Rank', y = 'Rating', title = 'Drop-off curves each year')
```


Yeah, I like that better. I'll plan on normalizing by year in the `py-glicko` read code.
